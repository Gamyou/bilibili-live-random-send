// ==UserScript==
// @author          Gamyou
// @version         1.5.9
// @note            23-12-03 1.5.9 新增弹幕源共享设置
// ==/UserScript==

!function(){window.autoSendDanmuModuleLoaded=!1;const e=URL.createObjectURL(new Blob(["(",function(){const e={};self.onmessage=(t=>{switch(t.data.command){case"interval:start":const a=setInterval(()=>postMessage({message:"interval:tick",id:t.data.id}),t.data.interval);e[t.data.id]=a;break;case"interval:clear":clearInterval(e[t.data.id]),postMessage({message:"interval:cleared",id:t.data.id}),delete e[t.data.id];break;case"timeout:start":const l=setTimeout(()=>postMessage({message:"timeout:tick",id:t.data.id}),t.data.timeout);e[t.data.id]=l;break;case"timeout:clear":clearTimeout(e[t.data.id]),postMessage({message:"timeout:cleared",id:t.data.id}),delete e[t.data.id]}})}.toString(),")()"],{type:"application/javascript"})),t=new Worker(e);URL.revokeObjectURL(e);const a={id:0,callbacks:{},setInterval:(e,l,d)=>{const n=++a.id;return a.callbacks[n]={fn:e,context:d},t.postMessage({command:"interval:start",interval:l,id:n}),n},setTimeout:(e,l,d)=>{const n=++a.id;return a.callbacks[n]={fn:e,context:d},t.postMessage({command:"timeout:start",timeout:l,id:n}),n},onMessage:e=>{switch(e.data.message){case"interval:tick":case"timeout:tick":const t=a.callbacks[e.data.id];t&&t.fn&&t.fn.apply(t.context);break;case"interval:cleared":case"timeout:cleared":delete a.callbacks[e.data.id]}},clearInterval:e=>t.postMessage({command:"interval:clear",id:e}),clearTimeout:e=>t.postMessage({command:"timeout:clear",id:e})};t.onmessage=a.onMessage.bind(a);let l,d,n,c,i,o,s,r,u,p,m,h,b,g,v,k,x,y,w,f,C,E,L,I,B,T,A,S,P,M,_,D,N,F,z,G,R,K,j,H,V,U={version:4,like:!1,random:!0,usePublic:!1,data1:{available:!0,values:["弹幕①","弹幕②"]},data2:{available:!0,values:[]},data3:{available:!0,values:[]},data4:{available:!0,values:["弹幕⑦"]},data5:{available:!0,values:[]}},O={},W={},$=[],q=[],J=null,Q=null,X=200,Y=0,Z=e=>{alert("请更新油猴脚本"),window.location.href=le},ee=(e,t)=>null,te=(e,t)=>{console.warn('===> No implementation "setGmValue" method.')},ae=e=>{console.warn('===> No implementation "delGmValue" method.')};const le="https://greasyfork.org/scripts/446725-b%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E5%AE%9A%E6%97%B6%E5%8F%91%E9%9A%8F%E6%9C%BA%E5%BC%B9%E5%B9%95/code/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E5%AE%9A%E6%97%B6%E5%8F%91%E9%9A%8F%E6%9C%BA%E5%BC%B9%E5%B9%95.user.js",de=window.location.pathname.replace(/^\/(\S+\/)*/g,""),ne=()=>(new Date).getTime(),ce=(e,t)=>{let a=document.getElementById("aside-area-vm").getElementsByClassName("chat-input border-box")[0];if(!a)return void alert("找不到输入弹幕文本框，请尝试刷新页面");let l=document.getElementsByClassName("bl-button bl-button--primary")[0];l?(a.value=e,a.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),l.click(),lastSent=ne()):alert("找不到发送按钮，请尝试刷新页面")},ie=e=>{if(!e||""==e)return!0;return new RegExp("^[ ]+$").test(e)},oe=()=>{for(let e=0;e<$.length;e++)a.clearInterval($[e]),$[e]=null;$=[]},se=()=>{if(l.checked){if(!Q){let e=ie(O.signText)?O.signText:"打卡",t=new Date(new Date((new Date).setDate((new Date).getDate()+1)).toDateString()).getTime()-ne();console.log("===> 设置凌晨打卡定时器【"+t+"】"),_.value=ie(W.signInText)?e:W.signInText,Q=a.setTimeout(()=>{ce(ie(_.value)?e:_.value),console.log("===> 设置下一次打卡"),a.clearTimeout(Q),Q=null,se()},t)}}else Q&&(console.log("===> 关闭自动打卡功能"),a.clearTimeout(Q),Q=null)},re=e=>{T.value=e.data1.values.length?e.data1.values.join("|"):[],A.value=e.data2.values.length?e.data2.values.join("|"):[],S.value=e.data3.values.length?e.data3.values.join("|"):[],P.value=e.data4.values.length?e.data4.values.join("|"):[],M.value=e.data5.values.length?e.data5.values.join("|"):[]},ue=()=>{x.checked=!1,y.checked=U.random,k.checked=U.usePublic,w.checked=U.data1.available,f.checked=U.data2.available,C.checked=U.data3.available,E.checked=U.data4.available,L.checked=U.data5.available,l.checked=W.autoSignIn,i.checked=W.noSleep,d.checked=W.hideLoginGuide,n.checked=W.hideHaruna,c.checked=W.hideShop,o.checked=W.hideGift,s.checked=W.hideRoomFeed,r.checked=W.hideRoomInfo,u.checked=W.hideNotice,p.checked=W.hideFooter,m.checked=W.lottery,b.checked=W.hesitation,h.checked=W.closeLottery,g.checked=W.noPrivacy,v.checked=W.hideWatermark,(()=>{Fe(),Ae(),Le(),fe(),Ce(),Ee(),Re(),se(),Se(),Pe(),Me(),De(),_e(),Ie(),Be(),Te();let e=a.setTimeout(()=>{a.clearTimeout(e),Ie(),Be(),Te()},1e3)})()},pe=()=>B.style.display="block",me=()=>{ue(),B.style.display="none"},he=()=>{if(U.data1.values.length<=0&&U.data2.values.length<=0&&U.data3.values.length<=0&&U.data4.values.length<=0&&U.data5.values.length<=0)return q||[];let e=[];e=U.data1.available?e.concat(U.data1.values):e,e=U.data2.available?e.concat(U.data2.values):e,e=U.data3.available?e.concat(U.data3.values):e,e=U.data4.available?e.concat(U.data4.values):e,e=U.data5.available?e.concat(U.data5.values):e,q=e,y.checked?q=(e=>{for(let t=0;t<e.length;t++){const a=Math.floor(Math.random()*e.length),l=e[t];e[t]=e[a],e[a]=l}return e})(e):Y=0},be=(e,t,l)=>{R.textContent=e,R.style.display="block",R.style.color=l||"#128712";let d=a.setTimeout(()=>{a.clearTimeout(d),R.style.display="none",R.textContent="",t&&(B.style.display="none")},1500)},ge=()=>{if(!O||ie(O.defaultKey)||ie(O.configKey))return void be("保存失败",!1,"red");O.configKey&&(W.autoSignIn=l.checked,W.signInText=_.value,W.noSleep=i.checked,W.hideLoginGuide=d.checked,W.hideHaruna=n.checked,W.hideShop=c.checked,W.hideGift=o.checked,W.hideRoomFeed=s.checked,W.hideRoomInfo=r.checked,W.hideNotice=u.checked,W.hideFooter=p.checked,W.lottery=m.checked,window.localStorage.setItem("lottery_checked",m.checked),W.hesitation=b.checked,window.localStorage.setItem("hesitation_checked",b.checked),W.hesitationExpiry=D.value,window.localStorage.setItem("hesitation_expiry",D.value),W.closeLottery=h.checked,window.localStorage.setItem("close_lottery_checked",W.closeLottery),W.noPrivacy=g.checked,W.hideWatermark=v.checked,te(O.configKey,W));let e=ie(T.value)?[]:T.value.split("|"),t=ie(A.value)?[]:A.value.split("|"),a=ie(S.value)?[]:S.value.split("|"),I=ie(P.value)?[]:P.value.split("|"),B=ie(M.value)?[]:M.value.split("|");if(U.random=y.checked,U.usePublic=k.checked,U.data1.available=w.checked,U.data2.available=f.checked,U.data3.available=C.checked,U.data4.available=E.checked,U.data5.available=L.checked,k.checked||(U.data1.values=e,U.data2.values=t,U.data3.values=a,U.data4.values=I,U.data5.values=B),te(de,U),x.checked){let l={data1:{},data2:{},data3:{},data4:{},data5:{}};l.data1.values=e,l.data2.values=t,l.data3.values=a,l.data4.values=I,l.data5.values=B,te(O.defaultKey,l)}k.checked&&(U.data1.values=e,U.data2.values=t,U.data3.values=a,U.data4.values=I,U.data5.values=B),he(),be("设置成功",!0)},ve=()=>{O.configKey&&W?(W.script="",W.lastUpdate="清除缓存",te(O.configKey,W),be("清除成功")):(console.warn("元数据丢失"),be("操作失败",!1,"red"))},ke=()=>q.length<1?(alert("请先设置弹幕"),!1):(y.checked&&(Y=Math.floor(Math.random()*q.length)),ce(q[Y]),++Y>=q.length&&(Y=0),!0),xe=()=>{let e=0;if(J)a.clearInterval(J),J=null,N.style.background=ie(G)?"rgba(217,157,27,1)":G,N.style.setProperty("--color",G.replace(")",", 0.8)")),N.textContent="开始",I.removeAttribute("disabled");else{if(e=1e3*(ie(I.value)?600:I.value),!ke())return;J=a.setInterval(ke,e),N.style.background="rgba(255,0,0,1)",N.style.setProperty("--color","rgba(255,0,0,0.8)"),N.textContent="停止",I.setAttribute("disabled","disabled")}},ye=(e,t,a,l,d,n,c,i,o,s)=>{let r=document.createElement("input");r.type="checkbox",r.id=e,r.checked=!1,l&&!s&&r.addEventListener("click",l);let u=document.createElement("label");u.setAttribute("for",e),u.classList.add("switch-check-label");let p=document.createElement("span");p.textContent=t,p.title=a,p.classList.add("danmu-random-switch-button-title"),s&&(r.disabled=!0,r.classList.add("disabled"),u.classList.add("disabled"),p.classList.add("disabled"));let m=document.createElement("div");return m.id=e+"Div",m.classList.add("switch-check"),m.classList.add("switch-check-group"),m.appendChild(r),m.appendChild(u),m.appendChild(p),ie(n)||(m.style.marginLeft=n),ie(c)||(m.style.width=c),i&&m.style.setProperty("display","none"),o&&m.appendChild(o),d.appendChild(m),r},we=(e,t)=>{t?e.style.setProperty("display","none","important"):e.style.removeProperty("display")},fe=()=>{let e=document.getElementById("switch-login-guide-vm");e&&we(e,d.checked)},Ce=()=>{let e=document.getElementById("my-dear-haruna-vm");e&&we(e,n.checked)},Ee=()=>{let e=document.getElementById("shop-popover-vm");e&&we(e,c.checked)},Le=()=>{let e=document.getElementsByClassName("gift-control-section")[0];e&&we(e,o.checked),(e=document.getElementById("web-player__bottom-bar__container"))&&we(e,o.checked),e=document.getElementsByTagName("video");for(let t=0;t<e.length;t++){if(!e[t])return;o.checked?e[t].style.setProperty("height","100%"):(document.body.classList.contains("player-full-win")||document.body.classList.contains("fullscreen-fix"))&&e[t].style.setProperty("height","calc(100% - 114px)")}},Ie=()=>{let e=document.getElementsByClassName("room-feed")[0];e&&we(e,s.checked),(e=document.getElementsByClassName("flip-view p-relative")[0])&&we(e,s.checked)},Be=()=>{let e=document.getElementsByClassName("room-info-ctnr")[0];e&&we(e,r.checked)},Te=()=>{let e=document.getElementsByClassName("right-container")[0];e&&(e.style.setProperty("min-height","auto"),we(e,u.checked))},Ae=()=>{let e=document.getElementById("link-footer-vm");e&&we(e,p.checked)},Se=()=>{if(g.checked){let e=document.createElement("style");e.id="hidePrivacyDialog",e.setAttribute("type","text/css"),e.innerHTML=".privacy-dialog{display:none !important;}",document.head.appendChild(e)}else{let e=document.getElementById("hidePrivacyDialog");e&&e.remove()}},Pe=()=>{let e=document.getElementsByClassName("web-player-icon-roomStatus")[0];e&&we(e,v.checked)},Me=()=>{window.localStorage.setItem("lottery_checked",m.checked);let e=document.getElementById("hesitationCheckboxDiv");e&&we(e,!m.checked)},_e=()=>{window.localStorage.setItem("close_lottery_checked",h.checked)},De=()=>{window.localStorage.setItem("hesitation_checked",b.checked),window.localStorage.setItem("hesitation_expiry",D.value)},Ne=()=>{},Fe=()=>{let e=k.checked?O.defaultKey:de,t=ee(e,null);t&&re(t)},ze=e=>{let t=document.getElementById("danmu-setting-panel");if(e&&!t){let t=document.getElementsByClassName("bl-button bl-button--primary")[0];if(!t)return console.warn("===> 发送按钮丢失"),!1;(e=>{let t=document.createElement("div");t.textContent="弹幕设置",t.classList.add("danmu-random-setting-title");let a=document.createElement("div");a.textContent="1.5.9",a.classList.add("danmu-random-setting-title-sub"),t.appendChild(a);let G=document.createElement("div");G.classList.add("danmu-random-setting-tips"),G.innerHTML='任一分组内输入弹幕即可，多条用<span style="color:#dc6b07;margin:0 2px 0 4px;font-weight:700;font-style:normal;">竖线</span>分隔';let K=document.createElement("div");K.classList.add("danmu-random-update-tips"),K.innerHTML='<span style="color:#f00">更新提示：</span>新增弹幕源共享设置';let j=document.createElement("div");j.textContent="分组 1 ：",j.classList.add("danmu-group-title"),(w=document.createElement("input")).type="checkbox",w.id="group1Checkbox",w.checked=!0;let H=document.createElement("label");H.setAttribute("for","group1Checkbox"),H.classList.add("switch-check-label");let V=document.createElement("div");V.classList.add("switch-check"),V.appendChild(w),V.appendChild(H),(T=document.createElement("textarea")).classList.add("danmu-group-textarea"),T.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔");let U=document.createElement("div");U.textContent="分组 2 ：",U.classList.add("danmu-group-title"),(f=document.createElement("input")).type="checkbox",f.id="group2Checkbox",f.checked=!0;let O=document.createElement("label");O.setAttribute("for","group2Checkbox"),O.classList.add("switch-check-label");let W=document.createElement("div");W.classList.add("switch-check"),W.appendChild(f),W.appendChild(O),(A=document.createElement("textarea")).classList.add("danmu-group-textarea"),A.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔");let $=document.createElement("div");$.textContent="分组 3 ：",$.classList.add("danmu-group-title"),(C=document.createElement("input")).type="checkbox",C.id="group3Checkbox",C.checked=!0;let q=document.createElement("label");q.setAttribute("for","group3Checkbox"),q.classList.add("switch-check-label");let J=document.createElement("div");J.classList.add("switch-check"),J.appendChild(C),J.appendChild(q),(S=document.createElement("textarea")).classList.add("danmu-group-textarea"),S.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔");let Q=document.createElement("div");Q.textContent="分组 4 ：",Q.classList.add("danmu-group-title"),(E=document.createElement("input")).type="checkbox",E.id="group4Checkbox",E.checked=!0;let X=document.createElement("label");X.setAttribute("for","group4Checkbox"),X.classList.add("switch-check-label");let Y=document.createElement("div");Y.classList.add("switch-check"),Y.appendChild(E),Y.appendChild(X),(P=document.createElement("textarea")).classList.add("danmu-group-textarea"),P.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔");let Z=document.createElement("div");Z.textContent="分组 5 ：",Z.classList.add("danmu-group-title"),(L=document.createElement("input")).type="checkbox",L.id="group5Checkbox",L.checked=!0;let ee=document.createElement("label");ee.setAttribute("for","group5Checkbox"),ee.classList.add("switch-check-label");let te=document.createElement("div");te.classList.add("switch-check"),te.appendChild(L),te.appendChild(ee),(M=document.createElement("textarea")).classList.add("danmu-group-textarea"),M.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔");let ae=document.createElement("div");ae.appendChild(j),ae.appendChild(V),ae.appendChild(T),ae.appendChild(U),ae.appendChild(W),ae.appendChild(A),ae.appendChild($),ae.appendChild(J),ae.appendChild(S),ae.appendChild(Q),ae.appendChild(Y),ae.appendChild(P),ae.appendChild(Z),ae.appendChild(te),ae.appendChild(M),y=ye("rdCheckbox","随机从上面的弹幕中选出一条发送","将合并所有分组数据，从中随机选出一条发送",null,ae),k=ye("usePublicCheckbox","使用共用弹幕源","使用设置为共用弹幕作为弹幕源",Fe,ae),ye("autoLikeCheckbox","自动点赞该直播间","开发中……",null,ae,null,null,null,null,!0);let le=document.createElement("div");le.textContent="以上设置对应各个直播间独立保存，无需刷新",le.title="请点击设置面板底下的“✓”进行保存",le.classList.add("global-setting-tip"),le.classList.add("switch-check-group"),ae.appendChild(le);let de=document.createElement("div");de.style.margin="20px 0 10px",(le=document.createElement("div")).textContent="以下设置，需刷新其它直播间才能适用",le.title="请点击设置面板底下的“✓”进行保存",le.classList.add("global-setting-tip"),le.classList.add("switch-check-group"),de.appendChild(le),(_=document.createElement("input")).style.border="0",_.style.width="90px",_.setAttribute("placeholder","输入打卡的文字"),(D=document.createElement("input")).style.border="0",D.style.width="55px",D.setAttribute("placeholder","单位：秒"),D.setAttribute("oninput","this.value = this.value.replace(/[^0-9]/g, '')"),x=ye("setPublicCheckbox","设为共用弹幕源","把这个直播间的弹幕共享给其它直播间使用，先后设置时，后面的会覆盖前面的设置",Ne,de),l=ye("signInCheckbox","打卡弹幕（需登录）：","每日零点发送一条打卡弹幕",se,de,null,null,!1,_),m=ye("lotteryCheckbox","自动参与天选时刻抽奖（需登录）","自动点击参与按钮，请确保已经登录了阿B账号",Me,de),b=ye("hesitationCheckbox","犹豫期：","不立刻参与天选时刻，这期间可以手动处理，免得自动参加后后悔（时间单位：秒）",De,de,"23px","90%",!0,D),h=ye("closeLotteryCheckbox","关闭天选时刻","关闭天选时刻弹窗",_e,de),i=ye("noSleepCheckbox","防止直播间休眠","防止直播间页面一段时间没操作之后进入休眠",Re,de),d=ye("hideLoginGuideCheckbox","隐藏播放器底部登录提示","隐藏未登录时播放器底部显示的登录提示",fe,de),n=ye("hideHarunaCheckbox","隐藏看板娘立绘","隐藏直播间Haruna立绘",Ce,de),c=ye("hideShopCheckbox","隐藏购物提示","隐藏播放器左上角的商店购物提示",Ee,de),o=ye("hideGiftControlCheckbox","隐藏礼物栏","隐藏播放器底部的礼物栏",Le,de),s=ye("hideRoomFeedCheckbox","隐藏主播动态","隐藏播放器底下主播的动态栏",Ie,de),r=ye("hideRoomInfoCheckbox","隐藏主播荣耀、简介","隐藏播放器底下主播的荣耀勋章和简介",Be,de),u=ye("hideNoticeCheckbox","隐藏主播公告","隐藏弹幕列表底下主播的公告",Te,de),p=ye("hideFooterCheckbox","隐藏直播间页脚","隐藏直播间底部的网页页脚",Ae,de),g=ye("hidePrivacyCheckbox","隐藏隐私提示对话框","隐藏隐私提示登录的对话框，被打码的昵称不保证变回正常",Se,de),v=ye("hideRoomStatusCheckbox","隐藏直播水印","隐藏播放器左上角的直播水印",Pe,de),(R=document.createElement("span")).classList.add("danmu-random-setting-success-text");let ne=document.createElement("div");ne.classList.add("danmu-random-setting-success-tips"),ne.appendChild(R);let ce=document.createElement("button");ce.textContent="清除缓存",ce.classList.add("clean-cache-btn"),ce.addEventListener("click",ve);let ie=document.createElement("i");ie.setAttribute("title","保存"),ie.style.padding="5px",ie.classList.add("el-button"),ie.classList.add("el-icon-check"),ie.classList.add("is-circle"),ie.addEventListener("click",ge);let oe=document.createElement("i");oe.setAttribute("title","关闭"),oe.style.padding="5px",oe.classList.add("el-button"),oe.classList.add("el-icon-close"),oe.classList.add("is-circle"),oe.addEventListener("click",me);let re=document.createElement("div");re.classList.add("danmu-random-set-button-container"),re.appendChild(ce),re.appendChild(ie),re.appendChild(oe);let ue=document.createElement("div");ue.classList.add("danmu-random-setting-bottom"),ue.appendChild(ne),ue.appendChild(re);let he=document.createElement("div");he.style.height="calc(98% - 30px - 25px)",he.appendChild(ae),he.appendChild(de),he.appendChild(ue),(B=document.createElement("div")).id="danmu-setting-panel",B.classList.add("danmu-random-setting-panel"),B.appendChild(t),B.appendChild(K),B.appendChild(G),B.appendChild(he),document.getElementById("aside-area-vm").appendChild(B),(N=document.createElement("button")).textContent="开始",N.classList.add("danmu-btn"),N.style.setProperty("--color","rgba(217,157,27,0.8)"),N.addEventListener("click",xe),(F=document.createElement("span")).textContent="每",F.classList.add("danmu-text-span"),F.style.marginLeft="4px",(I=document.createElement("input")).value=600,I.classList.add("danmu-second-input"),I.setAttribute("oninput","this.value = this.value.replace(/[^0-9]/g, '')"),(z=document.createElement("span")).textContent="秒发送",z.classList.add("danmu-text-span"),z.style.marginRight="4px";let be=document.createElement("i");be.classList.add("el-icon-setting");let ke=document.createElement("button");ke.title="设置",ke.classList.add("el-button"),ke.classList.add("el-button--mini"),ke.classList.add("is-circle"),ke.addEventListener("click",pe),ke.appendChild(be);let we=document.createElement("div");we.style.position="absolute",we.appendChild(N),we.appendChild(F),we.appendChild(I),we.appendChild(z),we.appendChild(ke),e.appendChild(we)})(e),G=window.getComputedStyle(t).getPropertyValue("background-color"),z.style.setProperty("background",G),F.style.setProperty("background",G),N.style.setProperty("background",G),N.style.setProperty("--color",G.replace(")",", 0.8)")),(()=>{let e=ee(de,null),t=de;if(e){if(e.usePublic&&O.defaultKey){let t=ee(O.defaultKey,null);t&&(e.data1.values=t.data1?t.data1.values:e.data1.values,e.data2.values=t.data2?t.data2.values:e.data2.values,e.data3.values=t.data3?t.data3.values:e.data3.values,e.data4.values=t.data4?t.data4.values:e.data4.values,e.data5.values=t.data5?t.data5.values:e.data5.values)}U.version===e.version?U=e:2===e.version?(U.data1=e.data1,U.data2=e.data2,U.data3=e.data3,U.data4=e.data4,U.data5=e.data5,te(t,U)):(U.data1.values=e.data1?e.data1.values:U.data1.values,U.data2.values=e.data2?e.data2.values:U.data2.values,U.data3.values=e.data3?e.data3.values:U.data3.values,U.data4.values=e.data4?e.data4.values:U.data4.values,U.data5.values=e.data5?e.data5.values:U.data5.values,te(t,U))}O.configKey&&(W=ee(O.configKey,{}),_.value=ie(W.signInText)?"":W.signInText,D.value=ie(W.hesitationExpiry)?"10":W.hesitationExpiry,ie(W.lottery)&&(W.lottery=!1),ie(W.closeLottery)&&(W.closeLottery=!1),ie(W.hesitation)&&(W.hesitation=!1)),re(U),ue(),he()})()}return!0},Ge=e=>{$[$.length]=a.setInterval(()=>{ze(e)?oe():0>=--X&&(oe(),console.log("===> 创建面板失败，停止初始化"))},1500)},Re=()=>{i.checked?K||(console.log("===> 开启防休眠功能"),K=a.setInterval(()=>{j=a.setTimeout(()=>{a.clearTimeout(j),document.body.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0}))},3e3*Math.random())},17e3)):(console.log("===> 关闭防休眠功能"),K&&(a.clearInterval(K),K=null),j&&(a.clearTimeout(j),j=null))},Ke=e=>{let t=document.getElementsByClassName("close-btn bg-contain")[0];t&&(ie(e)?t.click():closeLotteryTimer=a.setTimeout(()=>{a.clearTimeout(closeLotteryTimer),t.click()},1e3*e))},je=e=>{if(e)if("false"!==window.localStorage.getItem("lottery_checked"))if("true"===window.localStorage.getItem("hesitation_checked")){let t=window.localStorage.getItem("hesitation_expiry");t=ie(t)?1e4:1e3*t;let l=a.setTimeout(()=>{a.clearTimeout(l),console.log("===> 犹豫期过后自动参加抽奖"),e.click(),"true"===window.localStorage.getItem("close_lottery_checked")&&(console.log("===> 参加成功，延迟关闭弹窗"),Ke(1))},t)}else console.log("===> 立刻自动参加抽奖"),e.click(),"true"===window.localStorage.getItem("close_lottery_checked")&&(console.log("===> 参加成功，延迟关闭弹窗"),Ke(1));else"true"===window.localStorage.getItem("close_lottery_checked")&&(console.log("===> 不参与天选时刻抽奖，关闭弹窗"),Ke());else console.warn("===> 没有抽奖按钮DOM")};(()=>{let e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/element-ui@2.15.9/lib/theme-chalk/index.css",document.head.appendChild(e);let t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML='.danmu-group-title{font-size:14px;padding-left:2px;color:rgb(18,56,141);display:inline;margin-right:60%;vertical-align:middle;}.danmu-group-textarea{width:98%;min-height:100px;height:16%;margin:1px 0px 4px;border:0px;resize:none;}.el-button{display:inline-block;line-height:1;white-space:nowrap;cursor:pointer;background:#FFF;border:1px solid #DCDFE6;color:#606266;-webkit-appearance:none;text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box;outline:0;margin:0;-webkit-transition:.1s;transition:.1s;font-weight:500;padding:12px 20px;font-size:14px;border-radius:4px}.el-button.is-circle{border-radius:50%;padding:12px}.el-button--mini.is-circle{padding:3px;}.el-button:focus,.el-button:hover{color:#409EFF;border-color:#c6e2ff;background-color:#ecf5ff}.el-icon-close.is-circle{padding:5px;color:#ff0000;border:1px solid #ff0000;margin-left:20px;}.el-icon-check.is-circle{padding:5px;color:#0000ff;border:1px solid #0000ff;margin-left:20px;}input[type="checkbox"]{display:none;}.switch-check{display:inline-block;margin:0 5px;vertical-align:middle;}.switch-check-label{display:inline-block;vertical-align:middle;border:1px solid #bdc3c7;border-radius:60px;width:40px;height:18px;position:relative;transition:all .3s;cursor:pointer;}.switch-check-label:before{width:14px;height:14px;content:"";display:inline-block;background-color:#bdc3c7;border-radius:100%;position:absolute;top:2px;left:4px;transition:all .3s;}.switch-check :checked ~ label{background-color:#26b22b;border-color:#26b22b;}.switch-check :checked ~ label:before{left:22px;background-color:#fff;}.switch-check-group{margin-top:5px;width:95%;}.danmu-random-setting-panel{background-color:#d4f2e0;border-radius:2px;width:100%;height:100%;overflow-y:auto;position:absolute;left:0px;top:0px;z-index:999;display:none;}.danmu-random-setting-panel::-webkit-scrollbar{width:4px;height:4px;}.danmu-random-setting-panel::-webkit-scrollbar-thumb{border-radius:5px;-webkit-box-shadow:inset 0 0 5px rgba(0,0,0,0.2);background:rgba(0,0,0,0.2);}.danmu-random-setting-panel::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 5px rgba(0,0,0,0.2);border-radius:0;background:rgba(0,0,0,0.1);}.danmu-random-setting-title{text-align:center;font-size:16px;font-weight:700;color:#1c5adc;line-height:30px;}.danmu-random-setting-title-sub{display:inline-block;color:#ee8b8b;height:24px;vertical-align:sub;-webkit-transform:scale(0.7);}.danmu-random-setting-tips{color:#0b81cc;text-align:center;font-style:italic;}.danmu-random-update-tips{color:#0b81cc;text-align:center;font-size:13px;font-weight:700;margin:10px 0px;}.danmu-random-setting-bottom{width:100%;line-height:35px;}.danmu-random-switch-button-title{font-size:14px;vertical-align:middle;margin-left:5px;color:#095ca2;cursor:help;}.danmu-random-setting-success-tips{text-align:center;display:inline-block;vertical-align:middle;width:40%;}.danmu-random-setting-success-text{font-size:16px;color:#128712;display:none;}.danmu-random-set-button-container{display:inline-block;vertical-align:middle;}.global-setting-tip{padding-left:10px;color:red;font-size:14px;font-weight:700;cursor:help;}.disabled{color:#ababab;cursor:not-allowed;}.clean-cache-btn{min-width:70px;font-size:14px;border-radius:4px;color:#fff;background:#d99d1b;border:0px;cursor:pointer;vertical-align:middle;line-height:30px;}.clean-cache-btn:hover{background:rgba(217,157,27,0.8);color:#000}.danmu-btn{min-width:65px;height:24px;font-size:12px;border-radius:4px;color:rgb(255,255,255);background:rgb(217,157,27);border:0px;cursor:pointer;}.danmu-btn:hover{background:var(--color)!important;}.danmu-text-span{color:rgb(255, 255, 255);font-size:12px;background:rgb(236,108,27);}.danmu-second-input{width:25px;height:15px;margin:0px 3px;border:0px;border-radius:3px;}.not-display{display:none !important;}',document.head.appendChild(t)})(),window.runStart=(()=>{if((()=>{if(!O.version)return!0;if("2.4.2"===O.version)return!1;{let e=O.version.split("."),t="2.4.2".split(".");if(e.length!=t.length)return!0;for(let a=0;a<e.length;a++)if(t[a]>e[a])return!0;return!1}})())return void(window.location.href=le);let e=document.getElementsByClassName("particitation-btn")[0];e?je(e):H=a.setTimeout(()=>{a.clearTimeout(H),(e=document.getElementsByClassName("particitation-btn")[0])&&je(e)},2e3);let t=document.getElementsByClassName("bottom-actions p-relative")[0];if(t)Ge(t);else{let e=0;V=a.setInterval(()=>{(t=document.getElementsByClassName("bottom-actions p-relative")[0])?(a.clearInterval(V),Ge(t)):e++>=10&&(a.clearInterval(V),console.log(`===> 页面【${window.location.href}】没有定位位置`))},1e3)}}),window.arrayInfo=(()=>console.info(q)),window.setGmNotice=(e=>e),window.setGmGetValue=(e=>ee=e),window.setGmSetValue=(e=>te=e),window.setGmDelValue=(e=>e),window.setParentData=(e=>O=e),window.autoSendDanmuModuleLoaded=!0}();