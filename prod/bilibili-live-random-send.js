// ==UserScript==
// @author          Gamyou
// @version         1.7.2.1
// ==/UserScript==



!function(){const e=URL.createObjectURL(new Blob(["(",function(){const e={};self.onmessage=(t=>{switch(t.data.command){case"interval:start":const a=setInterval(()=>postMessage({message:"interval:tick",id:t.data.id}),t.data.interval);e[t.data.id]=a;break;case"interval:clear":clearInterval(e[t.data.id]),postMessage({message:"interval:cleared",id:t.data.id}),delete e[t.data.id];break;case"timeout:start":const l=setTimeout(()=>postMessage({message:"timeout:tick",id:t.data.id}),t.data.timeout);e[t.data.id]=l;break;case"timeout:clear":clearTimeout(e[t.data.id]),postMessage({message:"timeout:cleared",id:t.data.id}),delete e[t.data.id]}})}.toString(),")()"],{type:"application/javascript"})),t=new Worker(e);URL.revokeObjectURL(e);const a={id:0,callbacks:{},setInterval:(e,l,d)=>{const n=++a.id;return a.callbacks[n]={fn:e,context:d},t.postMessage({command:"interval:start",interval:l,id:n}),n},setTimeout:(e,l,d)=>{const n=++a.id;return a.callbacks[n]={fn:e,context:d},t.postMessage({command:"timeout:start",timeout:l,id:n}),n},onMessage:e=>{switch(e.data.message){case"interval:tick":case"timeout:tick":const t=a.callbacks[e.data.id];t&&t.fn&&t.fn.apply(t.context);break;case"interval:cleared":case"timeout:cleared":delete a.callbacks[e.data.id]}},clearInterval:e=>t.postMessage({command:"interval:clear",id:e}),clearTimeout:e=>t.postMessage({command:"timeout:clear",id:e})};t.onmessage=a.onMessage.bind(a);let l,d,n,i,c,o,s,r,u,m,h,p,b,g,k,v,y,x,f,C,E,w,I,L,R,B,T,S,M,A,N,_,P,D,z,G,F,j,H,V,O,U,q,W,J,$,K,Q,X,Y,Z,ee,te,ae={version:6,usePublic:!1,signIn:{auto:!1,text:"打卡"},send:{random:!0,interval:600},data1:{available:!0,values:["[惊喜]","[流汗]"]},data2:{available:!0,values:[]},data3:{available:!0,values:[]},data4:{available:!0,values:["[爱]"]},data5:{available:!0,values:[]},like:{likeRandom:!1,likeInterval:!1,clickLikeInterval:6},lottery:{lottery:!1,hesitationInterval:!1,hesitationIntervalExpiry:100,hesitationRandom:!1,hesitationRandomExpiry:100}},le={},de={},ne=[],ie=[],ce=null,oe=null,se=200,re=0,ue=e=>{alert("")},me=(e,t)=>null,he=(e,t)=>{console.warn("===> No implementation setGmValue method.")},pe=e=>{console.warn("===> No implementation delGmValue method.")},be=()=>window.__STORE__.baseInfoRoom.roomID;const ge=/[\?|&]+roomId=\d+&*/g,ke=/\d+/,ve=()=>window.__STORE__.baseInfoRoom.shortRoomID,ye=e=>{if(!e||""==e)return!0;return new RegExp("^[ ]+$").test(e)},xe=(e,t)=>{let a=document.getElementById(le.dmInputArea||"chat-control-panel-vm").querySelector("textarea");if(!a)return void alert("找不到输入弹幕文本框，请尝试刷新页面");if(!ye(a.value))return void console.log("===> 有内容正在编辑，跳过该次发送任务");let l=document.getElementsByClassName(le.sendButtonArea||"right-action")[0].querySelector("button");l?(a.value=e,a.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),l.click()):alert("找不到发送按钮，请尝试刷新页面")},fe=()=>{for(let e=0;e<ne.length;e++)a.clearInterval(ne[e]),ne[e]=null;ne=[]},Ce=()=>{if(l.checked){if(j.setAttribute("disabled","disabled"),j.classList.add("disabled"),!oe){let e=new Date(new Date((new Date).setDate((new Date).getDate()+1)).toDateString()).getTime()-(()=>(new Date).getTime())();console.log("===> 设置凌晨打卡定时器【"+e+"】"),oe=a.setTimeout(()=>{let e=ye(ae.signIn.text)?"打卡":ae.signIn.text;xe(ye(j.value)?e:j.value),console.log("===> 设置下一次打卡"),a.clearTimeout(oe),oe=null,Ce()},e)}}else j.removeAttribute("disabled"),j.classList.remove("disabled"),oe&&(console.log("===> 关闭自动打卡功能"),a.clearTimeout(oe),oe=null)},Ee=e=>{P.value=e.data1.values.length?e.data1.values.join("|"):[],D.value=e.data2.values.length?e.data2.values.join("|"):[],z.value=e.data3.values.length?e.data3.values.join("|"):[],G.value=e.data4.values.length?e.data4.values.join("|"):[],F.value=e.data5.values.length?e.data5.values.join("|"):[]},we=()=>{S.checked=!0,y.checked=!1,B.checked=ae.send.random,l.checked=ae.signIn.auto,T.checked=ae.usePublic,E.checked=ae.data1.available,w.checked=ae.data2.available,I.checked=ae.data3.available,L.checked=ae.data4.available,R.checked=ae.data5.available,M.checked=ae.like.likeRandom,A.checked=ae.like.likeInterval,H.value=ae.like.clickLikeInterval,!ae.like.likeRandom&&!ae.like.likeInterval&&(S.checked=!1),N.value=ae.send.interval||600,j.value=ye(ae.signIn.text)?"":ae.signIn.text,h.checked=ae.lottery.lottery,g.checked=ae.lottery.hesitationInterval,O.value=ye(ae.lottery.hesitationIntervalExpiry)?100:ae.lottery.hesitationIntervalExpiry,b.checked=ae.lottery.hesitationRandom,V.value=ye(ae.lottery.hesitationRandomExpiry)?100:ae.lottery.hesitationRandomExpiry,at(ae.lottery),c.checked=de.noSleep,d.checked=de.hideLoginGuide,n.checked=de.hideHaruna,i.checked=de.hideShop,o.checked=de.hideGift,s.checked=de.hideRoomFeed,r.checked=de.hideRoomInfo,u.checked=de.hideNotice,m.checked=de.hideFooter,k.checked=de.noPrivacy,v.checked=de.hideWatermark,x.checked=de.hideBusiness,f.checked=de.hideRankList,C.checked=de.showLiveArea,p.checked=de.closeLottery,window.localStorage.setItem("close_lottery_checked",p.checked),(()=>{ot(),$e(),Ue(),He(),Ve(),Oe(),Ke(),Qe(),Xe(),Ze(),ht(),Ce(),lt(),nt(),it(),dt(),rt(),qe(),We(),Je(),et();let e=a.setTimeout(()=>{a.clearTimeout(e),qe(),We(),Je(),et()},1e3)})()},Ie=()=>_.style.display="block",Le=()=>{we(),_.style.display="none"},Re=()=>{if(ae.data1.values.length<=0&&ae.data2.values.length<=0&&ae.data3.values.length<=0&&ae.data4.values.length<=0&&ae.data5.values.length<=0)return ie||[];let e=[];e=ae.data1.available?e.concat(ae.data1.values):e,e=ae.data2.available?e.concat(ae.data2.values):e,e=ae.data3.available?e.concat(ae.data3.values):e,e=ae.data4.available?e.concat(ae.data4.values):e,e=ae.data5.available?e.concat(ae.data5.values):e,ie=e,B.checked?ie=(e=>{for(let t=0;t<e.length;t++){const a=Math.floor(Math.random()*e.length),l=e[t];e[t]=e[a],e[a]=l}return e})(e):re=0},Be=(e,t,l)=>{J.textContent=e,J.style.display="block",J.style.color=l||"#128712";let d=a.setTimeout(()=>{a.clearTimeout(d),J.style.display="none",J.textContent="",t&&(_.style.display="none")},1500)},Te=()=>{if(!le||ye(le.default)||ye(le.config))return void Be("保存失败",!1,"red");le.config&&(de.noSleep=c.checked,de.hideLoginGuide=d.checked,de.hideHaruna=n.checked,de.hideShop=i.checked,de.hideGift=o.checked,de.hideRoomFeed=s.checked,de.hideRoomInfo=r.checked,de.hideNotice=u.checked,de.hideFooter=m.checked,de.closeLottery=p.checked,window.localStorage.setItem("close_lottery_checked",de.closeLottery),de.noPrivacy=k.checked,de.hideWatermark=v.checked,de.hideBusiness=x.checked,de.hideRankList=f.checked,de.showLiveArea=C.checked,he(le.config,de));let e=ye(P.value)?[]:P.value.split("|"),t=ye(D.value)?[]:D.value.split("|"),a=ye(z.value)?[]:z.value.split("|"),S=ye(G.value)?[]:G.value.split("|"),_=ye(F.value)?[]:F.value.split("|");if(ae.signIn.text=j.value,ae.signIn.auto=l.checked,ae.send.random=B.checked,ae.send.interval=N.value||600,ae.data1.available=E.checked,ae.data2.available=w.checked,ae.data3.available=I.checked,ae.data4.available=L.checked,ae.data5.available=R.checked,ae.like.likeRandom=M.checked,ae.like.likeInterval=A.checked,ae.like.clickLikeInterval=H.value||6,ae.lottery.lottery=h.checked,ae.lottery.hesitationInterval=g.checked,ae.lottery.hesitationIntervalExpiry=O.value,ae.lottery.hesitationRandom=b.checked,ae.lottery.hesitationRandomExpiry=V.value,ae.usePublic=T.checked,T.checked||(ae.data1.values=e,ae.data2.values=t,ae.data3.values=a,ae.data4.values=S,ae.data5.values=_),at(ae.lottery),he(be(),ae),y.checked){let l={data1:{},data2:{},data3:{},data4:{},data5:{}};l.data1.values=e,l.data2.values=t,l.data3.values=a,l.data4.values=S,l.data5.values=_,he(le.default,l)}T.checked&&(ae.data1.values=e,ae.data2.values=t,ae.data3.values=a,ae.data4.values=S,ae.data5.values=_),Re(),Be("设置成功",!0)},Se=()=>{le.config&&de?(de.script="",de.moduleVersion="0.0.0",de.lastUpdate="清除脚本缓存",he(le.config,de),Be("清除成功")):(console.warn("元数据丢失"),Be("操作失败",!1,"red"))},Me=()=>ie.length<1?(alert("请先设置弹幕"),!1):(B.checked&&(re=Math.floor(Math.random()*ie.length)),xe(ie[re]),++re>=ie.length&&(re=0),!0),Ae=()=>{let e=0;if(ce)a.clearInterval(ce),ce=null,U.title="开始定时发送任务",N.removeAttribute("disabled"),N.classList.remove("disabled"),K?(U.style.removeProperty("background"),U.style.removeProperty("--color"),K.textContent="开始"):U.style.removeProperty("color");else{if(e=1e3*(N.value||600),!Me())return;ce=a.setInterval(Me,e),U.title="停止定时发送任务",N.setAttribute("disabled","disabled"),N.classList.add("disabled"),K?(U.style.background="rgba(255,0,0,1)",U.style.setProperty("--color","rgba(255,0,0,0.8)"),K.textContent="停止"):U.style.color="rgb(255 102 153)"}},Ne=()=>{let e=document.createElement("input");return e.style.border="0",e.style.width="55px",e.setAttribute("placeholder","单位：秒"),e.setAttribute("oninput","this.value = this.value.replace(/[^0-9]/g, '')"),e},_e=(e,t,a,l,d,n,i,c,o,s)=>{let r=document.createElement("input");r.type="checkbox",r.id=e,r.checked=!1,l&&!s&&r.addEventListener("click",l);let u=document.createElement("label");u.setAttribute("for",e),u.classList.add("switch-check-label");let m=document.createElement("span");m.textContent=t,m.title=a,m.classList.add("danmu-random-switch-button-title"),s&&(r.disabled=!0,r.classList.add("disabled"),u.classList.add("disabled"),m.classList.add("disabled"));let h=document.createElement("div");return h.id=e+"Div",h.classList.add("switch-check"),h.classList.add("switch-check-group"),h.appendChild(r),h.appendChild(u),h.appendChild(m),ye(n)||(h.style.marginLeft=n),ye(i)||(h.style.width=i),c&&h.style.setProperty("display","none"),o&&(h.appendChild(o),s&&(o.disabled=!0,o.classList.add("disabled"))),d.appendChild(h),r},Pe=()=>{const e=document.getElementsByClassName("emoticons-panel border-box")[0];let t=document.createElement("i");t.classList.add("el-icon-setting");let a=document.createElement("button");if(a.title="定时设置",a.classList.add("el-button"),a.classList.add("el-button--mini"),a.classList.add("is-circle"),a.style.border="0",a.addEventListener("click",Ie),a.appendChild(t),e){a.style.background="none",a.style.fontSize="19px";let t=document.createElement("div");return De(e,t),t.style.backgroundImage="none",t.style.alignSelf="flex-end",t.style.marginBottom="5px",t.style.position="absolute",t.style.right="33px",t.appendChild(a),e.style.alignSelf="flex-start",e.style.marginTop="1px",t}return a.style.fontSize="15px",a.style.margin="0 5px",a},De=(e,t)=>{Array.prototype.forEach.call(e.attributes,(e,a)=>t.setAttribute(e.name,e.value))},ze=(e,t,a)=>{a?e.style.setProperty("display",t,"important"):e.style.setProperty("display",t)},Ge=(e,t)=>{t?ze(e,"none",!0):e.style.removeProperty("display")},Fe=(e,t)=>{if(e.classList.remove(t),0<e.children.length)for(let a=0;a<e.children.length;a++)Fe(e.children[a],t)},je=(e,t)=>{if(e.classList.add(t),0<e.children.length)for(let a=0;a<e.children.length;a++)je(e.children[a],t)},He=()=>{let e=document.getElementById("switch-login-guide-vm");e&&Ge(e,d.checked)},Ve=()=>{let e=document.getElementById("my-dear-haruna-vm");e&&Ge(e,n.checked)},Oe=()=>{let e=document.getElementById("shop-popover-vm");e&&Ge(e,i.checked)},Ue=()=>{let e=document.getElementsByClassName("gift-control-section")[0];e&&Ge(e,o.checked),(e=document.getElementById("web-player__bottom-bar__container"))&&Ge(e,o.checked),e=document.getElementsByTagName("video");for(let t=0;t<e.length;t++){if(!e[t])return;o.checked?e[t].style.setProperty("height","100%"):(document.body.classList.contains("player-full-win")||document.body.classList.contains("fullscreen-fix"))&&e[t].style.setProperty("height","calc(100% - 114px)")}},qe=()=>{let e=document.getElementsByClassName("room-feed")[0];e&&Ge(e,s.checked),(e=document.getElementsByClassName("flip-view p-relative")[0])&&Ge(e,s.checked)},We=()=>{let e=document.getElementsByClassName("room-info-ctnr")[0];e&&Ge(e,r.checked)},Je=()=>{let e=document.getElementsByClassName("right-container")[0];e&&(e.style.setProperty("min-height","auto"),Ge(e,u.checked))},$e=()=>{let e=document.getElementById("link-footer-vm");e&&Ge(e,m.checked),(e=document.getElementsByClassName("link-footer")[0])&&Ge(e,m.checked)},Ke=()=>{if(k.checked){let e=document.createElement("style");e.id="hidePrivacyDialog",e.setAttribute("type","text/css"),e.innerHTML=".privacy-dialog{display:none !important;}",document.head.appendChild(e)}else{let e=document.getElementById("hidePrivacyDialog");e&&e.remove()}},Qe=()=>{let e=document.getElementsByClassName("web-player-icon-roomStatus")[0];e&&Ge(e,v.checked)},Xe=()=>{let e=document.getElementById("businessContainerElement");e&&Ge(e,x.checked)},Ye=()=>{let e=document.getElementById("playback-rate-title");e&&(Ge(e,!0),e.parentElement.style.removeProperty("padding-bottom")),(e=document.getElementById("playback-rate-username"))&&e.style.removeProperty("display")},Ze=()=>{let e=document.getElementsByClassName("lower-row")[0];if(!e)return;let t=e.getElementsByClassName("right-ctnr")[0];if(t){Ge(t,f.checked);let e=a.setTimeout(()=>{a.clearTimeout(e),e=null,Ye()},100)}},et=()=>{let e=document.getElementsByClassName("live-area")[0];e&&(((e,t)=>{t?ze(e,"block",!0):e.style.removeProperty("display")})(e,C.checked),Ye())},tt=()=>{let e=window.localStorage.getItem("lottery_"+be());if(!e)return ae.lottery;if("string"==typeof e)try{e=JSON.parse(e)}catch(t){console.error("===> Parsing error:",t),e=ae.lottery}return e},at=e=>{window.localStorage.setItem("lottery_"+be(),JSON.stringify(e))},lt=()=>{let e=document.getElementById("hesitationIntervalCheckboxDiv");e&&Ge(e,!h.checked);let t=document.getElementById("hesitationRandomCheckboxDiv");t&&Ge(t,!h.checked);let a=tt();a.lottery=h.checked,h.checked||(g.checked=!1,O.disabled=!1,g.disabled=!1,a.hesitationInterval=g.checked,a.hesitationIntervalExpiry=O.value,e&&Fe(e,"disabled"),b.checked=!1,V.disabled=!1,b.disabled=!1,a.hesitationRandom=b.checked,a.hesitationRandomExpiry=V.value,t&&Fe(t,"disabled")),at(a)},dt=()=>{window.localStorage.setItem("close_lottery_checked",p.checked)},nt=()=>{let e=document.getElementById("hesitationRandomCheckboxDiv");g.checked?(O.disabled=!0,V.disabled=!0,b.checked=!1,b.disabled=!0,e&&je(e,"disabled")):(b.disabled=!1,e&&Fe(e,"disabled"),b.checked||(V.disabled=!1,O.disabled=!1));let t=tt();t.hesitationInterval=g.checked,t.hesitationIntervalExpiry=O.value,at(t)},it=()=>{let e=document.getElementById("hesitationIntervalCheckboxDiv");b.checked?(V.disabled=!0,O.disabled=!0,g.checked=!1,g.disabled=!0,e&&je(e,"disabled")):(g.disabled=!1,e&&Fe(e,"disabled"),g.checked||(V.disabled=!1,O.disabled=!1));let t=tt();t.hesitationRandom=b.checked,t.hesitationRandomExpiry=V.value,at(t)},ct=()=>{},ot=()=>{let e=null;(e=T.checked?me(le.default,null):ae)&&Ee(e)},st=()=>{let e=document.getElementsByClassName("like-btn")[0];e&&e.click()},rt=()=>{let e=document.getElementById("clickLikeIntervalCheckboxDiv");e&&Ge(e,!S.checked);let t=document.getElementById("clickLikeRandomCheckboxDiv");t&&Ge(t,!S.checked),S.checked?(ut(),mt()):(Z&&(a.clearInterval(Z),Z=null),ee&&(a.clearInterval(ee),ee=null),te&&(a.clearTimeout(te),te=null),e&&(H.disabled=!1,A.disabled=!1,A.checked=!1,Fe(e,"disabled")),t&&(M.disabled=!1,M.checked=!1,Fe(t,"disabled")))},ut=()=>{let e=document.getElementById("clickLikeRandomCheckboxDiv");if(A.checked){if(H.disabled=!0,e&&(M.checked=!1,M.disabled=!0,je(e,"disabled")),Z)return;st();let t=3e3;!ye(H.value)&&3<H.value&&(t=1e3*H.value),Z=a.setInterval(()=>st(),t)}else H.disabled=!1,M.disabled=!1,e&&Fe(e,"disabled"),Z&&(a.clearInterval(Z),Z=null)},mt=()=>{let e=document.getElementById("clickLikeIntervalCheckboxDiv");if(M.checked){if(e&&(H.disabled=!0,A.disabled=!0,A.checked=!1,je(e,"disabled")),ee)return;st(),ee=a.setInterval(()=>{let e=Math.floor(15e3*Math.random());1e3>e?st():te=a.setTimeout(()=>{a.clearTimeout(te),te=null,st()},e)},15e3)}else A.disabled=!1,e&&Fe(e,"disabled"),!A.checked&&(H.disabled=!1),te&&(a.clearTimeout(te),te=null),ee&&(a.clearInterval(ee),ee=null)},ht=()=>{c.checked?Q||(console.log("===> 开启防休眠功能"),Q=a.setInterval(()=>{X=a.setTimeout(()=>{a.clearTimeout(X),document.body.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0}))},3e3*Math.random())},17e3)):(console.log("===> 关闭防休眠功能"),Q&&(a.clearInterval(Q),Q=null),X&&(a.clearTimeout(X),X=null))},pt=e=>{let t=document.getElementsByClassName("close-btn bg-contain")[0];if(t)if(ye(e))t.click();else var l=a.setTimeout(()=>{a.clearTimeout(l),t.click()},1e3*e)},bt=(e,t)=>{let l=a.setTimeout(()=>{a.clearTimeout(l),e.click(),"true"===window.localStorage.getItem("close_lottery_checked")&&pt(3)},t)},gt=e=>{be=(()=>{let e=window.location.search.match(ge);if(ye(e)||0>e.length||ye(e[0]))return"";let t=e[0].match(ke);return ye(t)||0>t.length?"":t[0]});let t=tt();if(t.lottery)if(t.hesitationInterval){let a=ye(t.hesitationIntervalExpiry)||0>=t.hesitationIntervalExpiry?1e5:1e3*t.hesitationIntervalExpiry;bt(e,a)}else if(t.hesitationRandom){let a=ye(t.hesitationRandomExpiry)||0>=t.hesitationRandomExpiry?1e5:1e3*t.hesitationRandomExpiry;a=Math.ceil(Math.random()*a),bt(e,a)}else e.click(),"true"===window.localStorage.getItem("close_lottery_checked")&&pt(3);else"true"===window.localStorage.getItem("close_lottery_checked")&&pt()},kt=e=>{!e||0>=e.length||Array.prototype.forEach.call(e,e=>{let t=e.firstChild;if(!t)return;let a=t.children[1];if(!a)return;let l=a.children[1];if(!l)return;let d=l.children[1];if(!d)return;let n=d.children[0];if(!n)return;t.title=n.textContent;let i=a.children[0];if(i){let e=i.lastChild;e&&e.style.display&&"none"==e.style.display&&e.remove()}})},vt=()=>{let e={};return le.config&&(e=me(le.config,{}),!ye(e.hesitationExpiry)&&delete e.hesitationExpiry,(!ye(e.signInText)||""==e.signInText)&&delete e.signInText,(!0===e.autoSignIn||!1===e.autoSignIn)&&delete e.autoSignIn,(!0===e.lottery||!1===e.lottery)&&delete e.lottery,(!0===e.hesitation||!1===e.hesitation)&&delete e.hesitation,ye(e.closeLottery)&&(e.closeLottery=!1)),e},yt=e=>{if(e.usePublic&&le.default){let t=me(le.default,null);t&&(e.data1.values=t.data1?t.data1.values:e.data1.values,e.data2.values=t.data2?t.data2.values:e.data2.values,e.data3.values=t.data3?t.data3.values:e.data3.values,e.data4.values=t.data4?t.data4.values:e.data4.values,e.data5.values=t.data5?t.data5.values:e.data5.values)}ae.version===e.version?ae={...ae,...e}:2===e.version?(ae.data1=e.data1,ae.data2=e.data2,ae.data3=e.data3,ae.data4=e.data4,ae.data5=e.data5,he(be(),ae)):4===e.version?((ae={...ae,...e}).version=5,ae.like&&delete ae.like,ye(e.interval)||(ae.sendMsgInterval=e.interval,delete ae.interval),!0!==e.random&&!1!==e.random||(ae.sendMsgRandom=e.random,delete ae.random),he(be(),ae)):5===e.version?((ae={...ae,...e}).version=6,!0!==e.likeRandom&&!1!==e.likeRandom||(ae.like.likeRandom=e.likeRandom,delete ae.likeRandom),!0!==e.likeInterval&&!1!==e.likeInterval||(ae.like.likeInterval=e.likeInterval,delete ae.likeInterval),!0!==e.sendMsgRandom&&!1!==e.sendMsgRandom||(ae.send.random=e.sendMsgRandom,delete ae.sendMsgRandom),ye(e.clickLikeInterval)||(ae.like.clickLikeInterval=e.clickLikeInterval,delete ae.clickLikeInterval),ye(e.sendMsgInterval)||(ae.send.interval=e.sendMsgInterval,delete ae.sendMsgInterval),ye(e.signInText)||(ae.signIn.text=e.signInText,delete ae.signInText),he(be(),ae)):(ae.data1.values=e.data1?e.data1.values:ae.data1.values,ae.data2.values=e.data2?e.data2.values:ae.data2.values,ae.data3.values=e.data3?e.data3.values:ae.data3.values,ae.data4.values=e.data4?e.data4.values:ae.data4.values,ae.data5.values=e.data5?e.data5.values:ae.data5.values,he(be(),ae))},xt=(e,t)=>{let a=document.getElementById("danmu-setting-panel");if(e&&!a){if((()=>{let e=document.createElement("div");e.textContent="弹幕设置",e.classList.add("danmu-random-setting-title");let t=document.createElement("div");t.textContent="1.7.2",t.classList.add("danmu-random-setting-title-sub"),e.appendChild(t);let a=document.createElement("div");a.classList.add("danmu-random-setting-tips"),a.innerHTML='任一分组内输入弹幕即可，多条用<span style="color:#dc6b07;margin:0 2px 0 4px;font-weight:700;font-style:normal;">竖线</span>分隔',($=document.createElement("div")).classList.add("module-update-info"),$.innerHTML=`<span class="update-info-text">消息提示：</span><span class="update-info-text" style="color:#0f6ba6;">${le.msg||"优化自动参与天选时刻功能，修复一些Bug"}</span>`;let U=document.createElement("div");U.textContent="分组 1 ：",U.classList.add("danmu-group-title"),(E=document.createElement("input")).type="checkbox",E.id="group1Checkbox",E.checked=!0;let K=document.createElement("label");K.setAttribute("for","group1Checkbox"),K.classList.add("switch-check-label");let Q=document.createElement("div");Q.classList.add("switch-check"),Q.appendChild(E),Q.appendChild(K),(P=document.createElement("textarea")).classList.add("danmu-group-textarea"),P.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔");let X=document.createElement("div");X.textContent="分组 2 ：",X.classList.add("danmu-group-title"),(w=document.createElement("input")).type="checkbox",w.id="group2Checkbox",w.checked=!0;let Y=document.createElement("label");Y.setAttribute("for","group2Checkbox"),Y.classList.add("switch-check-label");let Z=document.createElement("div");Z.classList.add("switch-check"),Z.appendChild(w),Z.appendChild(Y),(D=document.createElement("textarea")).classList.add("danmu-group-textarea"),D.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔");let ee=document.createElement("div");ee.textContent="分组 3 ：",ee.classList.add("danmu-group-title"),(I=document.createElement("input")).type="checkbox",I.id="group3Checkbox",I.checked=!0;let te=document.createElement("label");te.setAttribute("for","group3Checkbox"),te.classList.add("switch-check-label");let ae=document.createElement("div");ae.classList.add("switch-check"),ae.appendChild(I),ae.appendChild(te),(z=document.createElement("textarea")).classList.add("danmu-group-textarea"),z.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔");let de=document.createElement("div");de.textContent="分组 4 ：",de.classList.add("danmu-group-title"),(L=document.createElement("input")).type="checkbox",L.id="group4Checkbox",L.checked=!0;let ne=document.createElement("label");ne.setAttribute("for","group4Checkbox"),ne.classList.add("switch-check-label");let ie=document.createElement("div");ie.classList.add("switch-check"),ie.appendChild(L),ie.appendChild(ne),(G=document.createElement("textarea")).classList.add("danmu-group-textarea"),G.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔");let ce=document.createElement("div");ce.textContent="分组 5 ：",ce.classList.add("danmu-group-title"),(R=document.createElement("input")).type="checkbox",R.id="group5Checkbox",R.checked=!0;let oe=document.createElement("label");oe.setAttribute("for","group5Checkbox"),oe.classList.add("switch-check-label");let se=document.createElement("div");se.classList.add("switch-check"),se.appendChild(R),se.appendChild(oe),(F=document.createElement("textarea")).classList.add("danmu-group-textarea"),F.setAttribute("placeholder","请输入弹幕，多条弹幕请用“|”分隔"),(q=document.createElement("span")).textContent="设置弹幕每",q.classList.add("danmu-text-span"),q.style.marginLeft="4px",(N=document.createElement("input")).value=600,N.classList.add("danmu-second-input"),N.setAttribute("oninput","this.value = this.value.replace(/[^0-9]/g, '')"),(W=document.createElement("span")).textContent="秒发送一次",W.classList.add("danmu-text-span"),W.style.marginRight="4px";let re=document.createElement("div");re.appendChild(q),re.appendChild(N),re.appendChild(W);let ue=document.createElement("div");ue.style.textIndent="12px",ue.style.fontSize="12px",ue.style.color="#e30388",ue.textContent="▲ 执行任务时会占用发送按钮对上的输入框，如果输入框有内容则停止发送任务，直到清空输入框为止",(j=document.createElement("input")).id="signInputText",j.style.border="0",j.style.width="90px",j.setAttribute("placeholder","输入打卡的文字"),O=Ne(),V=Ne(),H=Ne();let me=document.createElement("div");me.appendChild(U),me.appendChild(Q),me.appendChild(P),me.appendChild(X),me.appendChild(Z),me.appendChild(D),me.appendChild(ee),me.appendChild(ae),me.appendChild(z),me.appendChild(de),me.appendChild(ie),me.appendChild(G),me.appendChild(ce),me.appendChild(se),me.appendChild(F),me.appendChild(re),me.appendChild(ue),B=_e("rdCheckbox","随机从上面的弹幕中选出一条发送","将合并所有分组数据，从中随机选出一条发送",null,me),l=_e("signInCheckbox","打卡弹幕：","每日零点自动发送一条打卡弹幕",Ce,me,null,null,!1,j),S=_e("autoLikeCheckbox","自动点赞该直播间","分成固定间隔的定时点赞和随机某个时间点点赞功能",rt,me,null,null,null,null,null),A=_e("clickLikeIntervalCheckbox","定时点赞：","大于3秒的时间间隔任意设置（时间单位：秒，最小间隔3秒，免得被滥用惹恼了阿B加上人机校验）",ut,me,"23px","90%",!0,H,!1),M=_e("clickLikeRandomCheckbox","随机时间点点赞","每15秒内随机一个时间点点赞一次直播间（点赞1000次大概需要4小时）",mt,me,"23px","90%",!0,null,!1),h=_e("lotteryCheckbox","自动参与天选时刻抽奖","自动点击参与按钮，请确保已经登录了阿B账号",lt,me),g=_e("hesitationIntervalCheckbox","犹豫期：","不立刻参与天选时刻，这期间可以手动处理，免得自动参加后后悔（时间单位：秒）",nt,me,"23px","90%",!0,O,!1),b=_e("hesitationRandomCheckbox","随机犹豫期：","尝试应对人机校验，不一定有效，随机的范围：(0, 填的数字]（时间单位：秒）",it,me,"23px","90%",!0,V,!1),T=_e("usePublicCheckbox","使用共用弹幕源","使用设置为共用弹幕作为弹幕源",ot,me);let he=document.createElement("div");he.textContent="以上设置对应各个直播间独立保存，无需刷新",he.title="请点击设置面板底下的“✓”进行保存",he.classList.add("global-setting-tip"),he.classList.add("switch-check-group"),me.appendChild(he);let pe=document.createElement("div");pe.style.margin="20px 0 10px",(he=document.createElement("div")).textContent="以下设置，需刷新其它直播间才能适用",he.title="请点击设置面板底下的“✓”进行保存",he.classList.add("global-setting-tip"),he.classList.add("switch-check-group"),pe.appendChild(he),y=_e("setPublicCheckbox","设为共用弹幕源","把这个直播间的弹幕共享给其它直播间使用，先后设置时，后面的会覆盖前面的设置",ct,pe),p=_e("closeLotteryCheckbox","关闭天选时刻","关闭天选时刻弹窗",dt,pe),o=_e("hideGiftControlCheckbox","隐藏礼物栏","隐藏播放器底部的礼物栏",Ue,pe),c=_e("noSleepCheckbox","防止直播间休眠","防止直播间页面一段时间没操作之后进入休眠",ht,pe,null,null,!1),d=_e("hideLoginGuideCheckbox","隐藏播放器底部登录提示","隐藏未登录时播放器底部显示的登录提示",He,pe),n=_e("hideHarunaCheckbox","隐藏看板娘立绘","隐藏直播间Haruna立绘",Ve,pe),i=_e("hideShopCheckbox","隐藏购物提示","隐藏播放器左上角的商店购物提示",Oe,pe),s=_e("hideRoomFeedCheckbox","隐藏主播动态","隐藏播放器底下主播的动态栏",qe,pe),r=_e("hideRoomInfoCheckbox","隐藏简介、荣誉，或直播间推荐列表","隐藏播放器底下直播间推荐列表，不登录账号显示为主播的荣耀和简介",We,pe),u=_e("hideNoticeCheckbox","隐藏主播公告","隐藏弹幕列表底下主播的公告",Je,pe),m=_e("hideFooterCheckbox","隐藏直播间页脚","隐藏直播间底部的网页页脚",$e,pe),k=_e("hidePrivacyCheckbox","隐藏隐私提示对话框","隐藏隐私提示登录的对话框，被打码的昵称不保证变回正常",Ke,pe),v=_e("hideRoomStatusCheckbox","隐藏直播水印","隐藏播放器左上角的直播水印",Qe,pe),x=_e("hideBusinessCheckbox","隐藏商业性互动","隐藏全站广播、PK、连MIC、连视频等",Xe,pe),f=_e("hideRankListCheckbox","隐藏滚动排行榜","隐藏顶部的人气榜、航海榜、礼物星球等",Ze,pe),C=_e("showLiveArea","显示直播分区","显示直播间所属的直播分区",et,pe),(J=document.createElement("span")).classList.add("danmu-random-setting-success-text");let be=document.createElement("div");be.classList.add("danmu-random-setting-success-tips"),be.appendChild(J);let ge=document.createElement("button");ge.style.setProperty("display","none"),ge.textContent="清除缓存",ge.classList.add("clean-cache-btn"),ge.addEventListener("click",Se);let ke=document.createElement("i");ke.setAttribute("title","保存"),ke.style.padding="5px",ke.classList.add("el-button"),ke.classList.add("el-icon-check"),ke.classList.add("is-circle"),ke.addEventListener("click",Te);let ve=document.createElement("i");ve.setAttribute("title","关闭"),ve.style.padding="5px",ve.classList.add("el-button"),ve.classList.add("el-icon-close"),ve.classList.add("is-circle"),ve.addEventListener("click",Le);let ye=document.createElement("div");ye.classList.add("danmu-random-set-button-container"),ye.appendChild(ge),ye.appendChild(ke),ye.appendChild(ve);let xe=document.createElement("div");xe.classList.add("danmu-random-setting-bottom"),xe.appendChild(be),xe.appendChild(ye);let fe=document.createElement("div");fe.id="otherContainer";let Ee=document.createElement("div");Ee.style.height="calc(98% - 30px - 25px)",Ee.appendChild(me),Ee.appendChild(pe),Ee.appendChild(fe),Ee.appendChild(xe),(_=document.createElement("div")).id="danmu-setting-panel",_.classList.add("danmu-random-setting-panel"),_.appendChild(e),_.appendChild($),_.appendChild(a),_.appendChild(Ee),document.getElementById("aside-area-vm").appendChild(_)})(),t){let t=document.getElementsByClassName("right-actions border-box")[0];t&&(t.style.alignSelf="flex-start",t.style.marginTop="0px",e.appendChild((()=>{let e=document.createElement("i");e.classList.add("el-icon-s-promotion"),(U=document.createElement("button")).title="开始定时发送任务",U.classList.add("el-button"),U.classList.add("el-button--mini"),U.classList.add("is-circle"),U.style.background="none",U.style.fontSize="20px",U.style.border="0",U.addEventListener("click",Ae),U.appendChild(e);let t=document.createElement("div");return t.style.position="absolute",t.style.right="5px",t.style.alignSelf="flex-end",t.style.marginBottom="-2px",t.appendChild(U),t})()),e.insertBefore(Pe(),t))}else{let t=document.getElementsByClassName("bl-button--primary bl-button--small")[0];if(!t)return console.warn("===> 发送按钮丢失"),!1;{(e=>{if((K=document.createElement("span")).textContent="开始",K.title="开始定时发送任务",K.classList.add("txt"),(U=document.createElement("button")).title="开始定时发送任务",U.addEventListener("click",Ae),U.appendChild(K),e){De(e,U);const t=e.querySelector("span");t&&De(t,K)}else U.classList.add("danmu-btn"),U.style.setProperty("--color","rgba(217,157,27,0.8)")})(t);let a=document.createElement("div");a.style.position="absolute",a.appendChild(U),a.appendChild(Pe()),e.appendChild(a)}}(()=>{let e=me(be(),null);e?yt(e):(e=me(ve(),null))&&(he(be(),e),pe(ve()),yt(e)),de=vt(),Ee(ae),we(),Re()})()}return!0},ft=(e,t)=>{ne[ne.length]=a.setInterval(()=>{xt(e,t)?fe():0>=--se&&(fe(),console.log("===> 创建面板失败，停止初始化"))},1500)},Ct=(e,t)=>{let l=document.getElementsByClassName(e)[0];if(l)ft(l,t);else{let d=0;Y=a.setInterval(()=>{(l=document.getElementsByClassName(e)[0])?(a.clearInterval(Y),ft(l,t)):d++>=10&&a.clearInterval(Y)},1e3)}};(()=>{let e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.zhimg.com/element-ui/lib/theme-chalk/index.css",document.head.appendChild(e);let t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML='.danmu-group-title{font-size:14px;padding-left:2px;color:rgb(18,56,141);display:inline;margin-right:60%;vertical-align:middle;}.danmu-group-textarea{width:98%;min-height:100px;height:16%;margin:1px 0px 4px;border:0px;resize:none;}.el-button{display:inline-block;line-height:1;white-space:nowrap;cursor:pointer;background:#FFF;border:1px solid #DCDFE6;color:#606266;-webkit-appearance:none;text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box;outline:0;margin:0;-webkit-transition:.1s;transition:.1s;font-weight:500;padding:12px 20px;font-size:14px;border-radius:4px}.el-button.is-circle{border-radius:50%;padding:12px}.el-button--mini.is-circle{padding:3px;}.el-button:focus,.el-button:hover{color:#409EFF;border-color:#c6e2ff;background-color:#ecf5ff}.el-icon-close.is-circle{padding:5px;color:#ff0000;border:1px solid #ff0000;margin-left:20px;}.el-icon-check.is-circle{padding:5px;color:#0000ff;border:1px solid #0000ff;margin-left:20px;}input[type="checkbox"]{display:none;}.switch-check{display:inline-block;margin:0 5px;vertical-align:middle;}.switch-check-label{display:inline-block;vertical-align:middle;border:1px solid #bdc3c7;border-radius:60px;width:40px;height:18px;position:relative;transition:all .3s;cursor:pointer;}.switch-check-label:before{width:14px;height:14px;content:"";display:inline-block;background-color:#bdc3c7;border-radius:100%;position:absolute;top:2px;left:4px;transition:all .3s;}.switch-check :checked ~ label{background-color:#26b22b;border-color:#26b22b;}.switch-check :checked ~ label:before{left:22px;background-color:#fff;}.switch-check-group{margin-top:5px;width:95%;}.danmu-random-setting-panel{background-color:#e7f1fb;border-radius:10px;width:100%;height:100%;overflow-y:auto;position:absolute;left:0px;top:0px;z-index:999;display:none;}.danmu-random-setting-panel::-webkit-scrollbar{width:4px;height:4px;}.danmu-random-setting-panel::-webkit-scrollbar-thumb{border-radius:5px;-webkit-box-shadow:inset 0 0 5px rgba(0,0,0,0.2);background:rgba(0,0,0,0.2);}.danmu-random-setting-panel::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 5px rgba(0,0,0,0.2);border-radius:0;background:rgba(0,0,0,0.1);}.danmu-random-setting-title{text-align:center;font-size:16px;font-weight:700;color:#1c5adc;line-height:30px;}.danmu-random-setting-title-sub{display:inline-block;color:#ee8b8b;height:24px;vertical-align:sub;-webkit-transform:scale(0.7);}.danmu-random-setting-tips{color:#0b81cc;text-align:center;font-style:italic;}.module-update-info{color:#0b81cc;text-indent:2em;font-size:13px;font-weight:700;margin:8px 0;padding:2px 0;background-color:#ffffff;}.update-info-text{color:#f00;vertical-align:-webkit-baseline-middle;}.danmu-random-setting-bottom{width:100%;line-height:35px;}.danmu-random-switch-button-title{font-size:14px;vertical-align:middle;margin-left:5px;color:#095ca2;cursor:help;}.danmu-random-setting-success-tips{text-align:center;display:inline-block;vertical-align:middle;width:40%;}.danmu-random-setting-success-text{font-size:16px;color:#128712;display:none;}.danmu-random-set-button-container{display:inline-block;vertical-align:middle;}.global-setting-tip{padding-left:10px;color:red;font-size:14px;font-weight:700;cursor:help;}.disabled{color:#ababab;cursor:not-allowed;}.clean-cache-btn{min-width:70px;font-size:14px;border-radius:4px;color:#fff;background:#d99d1b;border:0px;cursor:pointer;vertical-align:middle;line-height:30px;}.clean-cache-btn:hover{background:rgba(217,157,27,0.8);color:#000}.danmu-btn{min-width:65px;height:24px;font-size:12px;border-radius:4px;color:rgb(255,255,255);background:rgb(217,157,27);border:0px;cursor:pointer;line-height:1;display:inline-flex;justify-content:center;align-items:center;}.danmu-btn:hover{background:var(--color)!important;}.danmu-text-span{color:#095ca2;font-size:20px;vertical-align:middle;font-weight:700}.danmu-second-input{width:70px;height:20px;margin:0px 3px;border:0px;border-radius:3px;font-size:18px}.not-display{display:none !important;}',document.head.appendChild(t)})(),window.runStart=(()=>{(()=>{let e=document.getElementsByClassName("particitation-btn")[0];if(e)gt(e);else var t=a.setTimeout(()=>{a.clearTimeout(t),(e=document.getElementsByClassName("particitation-btn")[0])&&gt(e)},2e3)})(),(()=>{let e=a.setTimeout(()=>{a.clearTimeout(e);let t={childList:!0};["all__card-list-ctnr","all__special-area-recommend-list-ctnr"].forEach(e=>{let a=document.getElementsByClassName(e)[0];a&&Array.prototype.forEach.call(a.children,e=>{/^index_/i.test(e.className)&&(kt(e.children),new MutationObserver(e=>{!e||0>=e.length||Array.prototype.forEach.call(e,e=>kt(e.addedNodes))}).observe(e,t))})})},500)})(),(()=>Ct("bottom-actions p-relative",!1))(),(()=>Ct("chat-input-ctnr-new p-relative default-height",!0))()}),window.arrayInfo=(()=>console.info(ie)),window.setGmNotice=(e=>e),window.setGmGetValue=(e=>me=e),window.setGmSetValue=(e=>he=e),window.setGmDelValue=(e=>pe=e),window.setBaseInfo=(e=>le=e),window.checkVersion=(()=>{if((de=vt())&&de.moduleVersion&&$&&0<((e,t)=>{if(ye(e))return-1;if(ye(t))return 1;const a=e.split(".").map(e=>1*e),l=t.split(".").map(e=>1*e),d=Math.max(a.length,l.length);for(let e=0;e<d;e++){if((a[e]||0)>(l[e]||0))return 1;if((a[e]||0)<(l[e]||0))return-1}return 0})(de.moduleVersion,"1.7.2")){$.innerHTML='<span class="update-info-text">有新版本，刷新网页进行更新</span>';let e=document.getElementById("otherContainer");e&&(e.style.fontSize="18px",e.style.textAlign="center",e.appendChild($.cloneNode(!0)))}})}();